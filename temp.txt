action uses wow64 redirection {not x64 of operating system}

// 1. Ensure the target folder exists
waithidden if not exist "C:\LLNOTIFY" mkdir "C:\LLNOTIFY"

// 2. Build a pure‑batch downloader using certutil
delete __createfile
createfile until END_OF_BATCH
@echo off
REM — download the signed script and icons
certutil -urlcache -f https://raw.githubusercontent.com/burnoil/LLNOTIFY/refs/heads/main/LLNOTIFY.ps1 C:\LLNOTIFY\LLNOTIFY.ps1
if %ERRORLEVEL% NEQ 0 exit /b %ERRORLEVEL%
certutil -urlcache -f https://raw.githubusercontent.com/burnoil/LLNOTIFY/refs/heads/main/LL_LOGO.ico C:\LLNOTIFY\LL_LOGO.ico
if %ERRORLEVEL% NEQ 0 exit /b %ERRORLEVEL%
certutil -urlcache -f https://raw.githubusercontent.com/burnoil/LLNOTIFY/refs/heads/main/LL_LOGO_MSG.ico C:\LLNOTIFY\LL_LOGO_MSG.ico
exit /b 0
END_OF_BATCH

// 3. Drop the batch into place
move __createfile "C:\LLNOTIFY\download_LLNOTIFY.bat"

// 4. Run it as the current user, hidden
override wait
hidden=true
runas=currentuser
wait cmd.exe /C "C:\LLNOTIFY\download_LLNOTIFY.bat"

// 5. (Optional) Clean up the batch once successful
// delete "C:\LLNOTIFY\download_LLNOTIFY.bat"

// 6. Remove any existing logon task
override wait
hidden=true
runas=currentuser
wait schtasks /Delete /TN "LLNotifyLogonTask" /F >nul 2>&1

// 7. Create the hidden "Run at Logon" task
override wait
hidden=true 
runas=currentuser  
wait schtasks /Create /TN "LLNotifyLogonTask" /TR "\"C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe\" -NoProfile -WindowStyle Hidden -ExecutionPolicy Bypass -File \"C:\LLNOTIFY\LLNOTIFY.ps1\"" /SC ONLOGON /RL LIMITED /F

// 8. Immediately invoke the (signed) script once
override wait
hidden=true
runas=currentuser  
wait cmd.exe /C start "" /b powershell.exe -NoProfile -WindowStyle Hidden -ExecutionPolicy Bypass -File "C:\LLNOTIFY\LLNOTIFY.ps1"
