action uses wow64 redirection {not x64 of operating system}

// 1. Ensure the target folder exists
waithidden if not exist "C:\LLNOTIFY" mkdir "C:\LLNOTIFY"

// 2. Download the latest LLNOTIFY.ps1 via PowerShell (no hash needed)
override wait hidden=true runas=currentuser
wait powershell.exe -ExecutionPolicy Bypass -NoProfile -WindowStyle Hidden -Command ^
"try {
    Invoke-WebRequest `
      -Uri 'https://raw.githubusercontent.com/burnoil/LLNOTIFY/refs/heads/main/LLNOTIFY.ps1' `
      -OutFile 'C:\LLNOTIFY\LLNOTIFY.ps1' `
      -UseBasicParsing
} catch {
    Write-Error 'LLNOTIFY download failed'; exit 1
}"

// 3. Remove any existing scheduled task
override wait hidden=true runas=currentuser
wait schtasks /Delete /TN "LLNotifyLogonTask" /F >nul 2>&1

// 4. Create the logon task (hidden)
override wait hidden=true runas=currentuser
wait schtasks /Create /TN "LLNotifyLogonTask" ^
    /TR "\"powershell.exe -ExecutionPolicy Bypass -NoProfile -WindowStyle Hidden -File C:\LLNOTIFY\LLNOTIFY.ps1\"" ^
    /SC ONLOGON /RL LIMITED /F

// 5. Run it immediately once
override wait hidden=true runas=currentuser
wait powershell.exe -ExecutionPolicy Bypass -NoProfile -WindowStyle Hidden -File "C:\LLNOTIFY\LLNOTIFY.ps1"
