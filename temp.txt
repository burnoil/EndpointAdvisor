action uses wow64 redirection {not x64 of operating system}

// 1. Ensure target folder exists
waithidden if not exist "C:\LLNOTIFY" mkdir "C:\LLNOTIFY"

// 2. Build a downloader batch (no .ps1 dropped)
delete __createfile
createfile until END_OF_BATCH
@echo off
REM â€” Inline PowerShell is allowed under AllSigned
powershell.exe -NoProfile -WindowStyle Hidden -ExecutionPolicy Bypass -EncodedCommand ewAgAC0ALQBVACAAJwBodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vYnVybm9pbC9MTE5PVElUWy9yZWZzL2hlYWRzL21haW4vTExOT1RJVFkucHNXJwAgAC0ATwB1AHQARgBpAGwAZQAgACcAQwA6AFwATABMAC4ATABOCABOAFQATwBIVAAnADsAIABJAG4AdgBvAGsAZgBlAC0AVwBlAGIAcgBlAHMAdQBnAGUAcgAgAC0AVQByAGkAIABLAEQ6AC8ALwByAGkAbwhtAEcAaQB0AGgAdQBiAHUAcwBlAHIAYwBvAG0ALwBCLgAuAFMAbwBtAGUAYwBvAG0AcABvAG4AZQAvQkxMTk9USVRZLnBzMQAgAC0ATwB1AHQARgBpAGwAZQAgACcAQwA6AFwATABMAC4ATABOCABOAFQATwBIVAAnACAAfQAgAGMAYQB0AGMAeAAgeyBlAHgAaQB0ACAAAQAxACAAfQ==
END_OF_BATCH

// 3. Move the batch into place
move __createfile "C:\LLNOTIFY\download_LLNOTIFY.bat"

// 4. Run the batch as the current user (hidden)
override wait
hidden=true
runas=currentuser
wait cmd.exe /C "C:\LLNOTIFY\download_LLNOTIFY.bat"

// 5. Delete any existing logon task
override wait hidden=true runas=currentuser
wait schtasks /Delete /TN "LLNotifyLogonTask" /F >nul 2>&1

// 6. Create the hidden logon task
override wait hidden=true runas=currentuser
wait schtasks /Create /TN "LLNotifyLogonTask" ^
    /TR "\"powershell.exe -NoProfile -WindowStyle Hidden -ExecutionPolicy Bypass -File C:\LLNOTIFY\LLNOTIFY.ps1\"" ^
    /SC ONLOGON /RL LIMITED /F

// 7. Run the newly downloaded signed script immediately
override wait hidden=true runas=currentuser
wait powershell.exe -NoProfile -WindowStyle Hidden -ExecutionPolicy Bypass -File "C:\LLNOTIFY\LLNOTIFY.ps1"
