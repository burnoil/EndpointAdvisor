folder create "C:\temp"

// Check for open offers whose source fixlet is from the "LL ISD Managed (Workstations)" site and is an "Update"
if {number of open bes actions whose (offer of it and exists source fixlet of it whose (value of header "X-Fixlet-Source" of it contains "Update" and name of site of it is "LL ISD Managed (Workstations)")) > 0}
   appendfile {concatenation "%0d%0a" of unique values of names of open bes actions whose (offer of it and exists source fixlet of it whose (value of header "X-Fixlet-Source" of it contains "Update" and name of site of it is "LL ISD Managed (Workstations)"))}
endif

// Check for open offers whose source fixlet is from the "LL Application Deployments" site and is an "Update"
if {number of open bes actions whose (offer of it and exists source fixlet of it whose (value of header "X-Fixlet-Source" of it contains "Update" and name of site of it is "LL Application Deployments)")) > 0}
   appendfile {concatenation "%0d%0a" of unique values of names of open bes actions whose (offer of it and exists source fixlet of it whose (value of header "X-Fixlet-Source" of it contains "Update" and name of site of it is "LL Application Deployments)"))}
endif

// Only move if __appendfile was created (i.e. it exists)
if {exists file "__appendfile"}
    // Updated filename to be more descriptive
    delete "C:\Temp\Pending_SSA_Offers_Count.txt" // safely remove if already exists
    move __appendfile "C:\Temp\Pending_SSA_Offers_Count.txt"
endif

// Cleanup if no pending "Update" offers from the specified sites were found
if {number of open bes actions whose (offer of it and exists source fixlet of it whose (value of header "X-Fixlet-Source" of it contains "Update" and name of site of it is "LL ISD Managed (Workstations)")) = 0 and number of open bes actions whose (offer of it and exists source fixlet of it whose (value of header "X-Fixlet-Source" of it contains "Update" and name of site of it is "LL Application Deployments)")) = 0}
delete "C:\Temp\Pending_SSA_Offers_Count.txt"
endif
